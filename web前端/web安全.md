## Web前端之安全

  前端安全是相对于打前端说的，这里是包含后台的（nodeJs/java/c）

  相对于狭义的前端（前后端分离的前端）来说，前端的所有内容都是不安全。可以说前端展示的内容没有安全可言（毕竟整个前端的文件、协议都被暴露给用户了）。

### 造成前端安全的原因有哪些

  1. 一般前端项目都是toC项目，也就是面向所有的用户。这样对于网络安全最基本的限IP，限MAC的方式不能用。除非是针对少数人开发的前端项目。
  
  2. 前端的数据获取方式是HTTP协议。协议的数据传输无法判断是从部署的网站发送的。也就是没有办法判断协议是正常的两端通信。

  3. 前端部署的文件文件对用户完全暴露。并且不用任何反编译基本上就可以看到源码。用户是可以直接将代码下载下来，搭建一个一样的前端网站的。

  4. 协议返回的数据透明。不管何种加密手段进行协议传输，由于前端代码暴露，并且最终协议返回结果需要在前端使用，因此前端的加解密过程都是暴露的。

### 前端曾在哪些安全问题

1. XSS（Cross Site Scripting）跨站脚本攻击

  - 原理 页面渲染的数据中包含可运行的脚本
  - 攻击方式： 反射型（url参数直接注入）和存储型（存储到DB后读取时注入）
  - 注入点： 上传的文件，提交的数据参数，请求参数，文章上传， 返回数据修改
    
  主要的操作其实简单来说就是对http请求或者返回的数据做修改，将脚本上传到服务器或者注入到用户访问的页面中。

  上传到服务器，主要是修改HTTP提交参数或者上传文件，上传文章等方式将脚本注入到服务器。这里的防范主要是服务器，前端只是增加当前访问页面的安全性

  修改服务器的返回注册脚本到页面上。这个主要是访问用户被内部网络劫持了（对于这种其实各种防范都会失效，毕竟网络被代理了，所有的网络数据都是透明的。但是针对的用户只是被代理的用户而已）

2. CSRF（Cross Site Request Forgy）跨站请求伪造
  
  - 原理：在第三方网站向本网站发起请求
  - 攻击方式： 监听用户的session。 获取用户的session信息后。模拟用户操作
  
3. 插入Iframe。例如广告等

上面说的2，3中方式其实都是一样的，简单的说还是在HTTP协议上进行处理，或者下载的js文件进行处理，篡改代码等。这个前提就是协议被拦截，或者用户被注册了脚本。也就是必须在1的操作手段下做处理

其实除了上面的三种，我个人认为还有以下

1. 跨权限获取数据。
   
  - 操作方式：例如我的userId为1，那我就猜测肯定存在userId：2, 3...。 从而修改userId进行获取别人的数据

2. 访问不可见的页面

  - 操作方式：例如页面的路由有A,B,C三个页面，普通用户正常逻辑只能访问A，B两个页面，都是由于路由暴露，从而到是用户强制访问C页面

3. 编辑公告，或者上传文章的时候。注册自己远程的监控地址

4. 密码撞库。用户当前用户的密码去访问其他网站
   
5. 制作相似的钓鱼网站

### 预防手段

1. XSS攻击防御

- 浏览器自带防御机制，主要应对反射型攻击（HTML内容或属性）：http响应头中自动添加x-xss-protection，值为0（关闭），1（打开），默认打开

- 对特定字符做转义：内容注入替换尖括号（ < => &lt;   > => &gt; ） 属性注入替换单引号或双引号（ " => &quot;  ' => &#39; ）

- CSP（Content Security Policy）内容安全策略：用于指定哪些内容可执行
  
  主要的操作在后台控制，前端防范的是防止脚本注入到页面，其实已经到了用户可以修改请求的返回报文，其实前端所有的防范都是失效。（如果可以修改用户的请求返回报文，就说明可以修改js脚本的返回。与其修改HTTP，不如直接修改页面的返回）。当然，防止脚本注入可以稍微提高一点安全。处理方式对服务器返回的数据不信任。进行特殊字符转换

  前端我的预防措施其实只能稍微增长破解的时间，其实根本无法组织攻击。真正的安全处理其实在后端或者后端和前端结合处理。

2. CSRF攻击防御

  简单说就是增加session标识的难度。例如添加时效性Token等

3. 其他的其实都需要后台配合。例如用户权限，用户访问路径管理
   
### 注

对于用户的网络被拦截，其实前端采用何种手段都是无效。主要还是提高访问用户的安全意识